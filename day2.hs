data Color = R | G | B
type Id = Int
type Draw = [(Int, Color)] -- assume: at most one (Int, Color) per each color in a draw.
data Game = Game Id [Draw]

-- part one
validIdOrZero :: (Color -> Int) -> Game -> Int
validIdOrZero limit (Game id draws) = if isValid then id else 0
  where isValid = (all . all) (\(num,color) -> num <= limit color) draws

solve1 :: (Color -> Int) -> [Game] -> Int
solve1 limit games = sum (map (validIdOrZero limit) games)

-- part two
powerSet :: Game -> Int
powerSet (Game _ draws) = multiply (foldl maxNum (0,0,0) (concat draws))
  where maxNum (r,g,b) (num, R) = (max r num, g, b)
        maxNum (r,g,b) (num, G) = (r, max g num, b)
        maxNum (r,g,b) (num, B) = (r, g, max b num)
        multiply (r,g,b) = r * g * b

solve2 :: [Game] -> Int
solve2 games = sum (map powerSet games)


main = do
  putStr "The solution to part one is: "
  putStrLn (show (solve1 inputLimit inputGames))
  putStr "The solution to part two is: "
  putStrLn (show (solve2 inputGames))

inputLimit R = 12
inputLimit G = 13
inputLimit B = 14

inputGames = 
  [ Game 1 [[(1,B)],[(4,G),(5,B)],[(11,R),(3,B),(11,G)],[(1,R),(10,G),(4,B)],[(17,R),(12,G),(7,B)],[(3,B),(19,G),(15,R)]]
  , Game 2 [[(17,R),(10,G)],[(3,B),(17,R),(7,G)],[(10,G),(1,B),(10,R)],[(7,G),(15,R),(1,B)],[(7,G),(8,B),(16,R)],[(18,R),(5,G),(3,B)]]
  , Game 3 [[(10,B),(3,G),(8,R)],[(15,G),(14,B),(1,R)],[(8,B),(11,R),(2,G)],[(5,R),(9,G),(6,B)]]
  , Game 4 [[(1,R),(3,B)],[(3,B),(3,G),(1,R)],[(11,B),(2,G)],[(2,G),(14,B)],[(1,G),(7,B)],[(11,B),(5,G)]]
  , Game 5 [[(9,G),(5,R),(10,B)],[(9,R),(4,B),(12,G)],[(9,G),(6,B),(14,R)],[(16,G),(8,R),(6,B)],[(11,B),(13,R),(1,G)]]
  , Game 6 [[(1,B),(2,G),(16,R)],[(1,G),(19,R)],[(1,B)],[(3,B),(2,R),(1,G)],[(18,R),(2,B),(1,G)]]
  , Game 7 [[(2,B),(9,R),(5,G)],[(11,B),(6,G),(4,R)],[(7,R),(3,G),(5,B)],[(5,G),(11,B),(7,R)],[(17,B),(4,R),(3,G)],[(20,B),(1,G),(2,R)]]
  , Game 8 [[(1,G),(6,R),(4,B)],[(8,G),(4,B),(2,R)],[(2,B),(5,G)]]
  , Game 9 [[(1,G),(5,B)],[(4,B)],[(2,R),(1,B)]]
  , Game 10 [[(1,G),(12,B)],[(6,R),(4,G)],[(5,G),(14,B),(9,R)],[(6,R),(13,B),(2,G)],[(6,R),(17,B),(1,G)]]
  , Game 11 [[(19,G),(1,R)],[(15,R),(7,G)],[(1,B),(8,R),(14,G)],[(1,B),(11,G),(1,R)]]
  , Game 12 [[(4,R),(3,G),(12,B)],[(4,G),(13,R)],[(2,G),(15,B),(5,R)],[(5,R),(10,B),(3,G)],[(3,G),(17,B),(17,R)],[(1,R),(4,G),(15,B)]]
  , Game 13 [[(5,R),(7,B)],[(6,R),(1,G),(11,B)],[(17,B),(11,G),(4,R)],[(6,R),(9,G),(5,B)],[(4,G),(14,B)]]
  , Game 14 [[(6,R),(15,B),(3,G)],[(4,G),(4,B),(3,R)],[(3,B),(1,G),(5,R)]]
  , Game 15 [[(4,G),(3,B),(6,R)],[(3,B),(2,R),(4,G)],[(15,R),(3,G),(4,B)],[(11,R),(2,B),(1,G)]]
  , Game 16 [[(4,G),(1,B),(12,R)],[(10,G),(6,B),(10,R)],[(1,B),(2,G),(15,R)],[(1,G),(3,R),(4,B)]]
  , Game 17 [[(10,G),(11,B)],[(13,G),(10,B),(3,R)],[(8,R),(3,G),(10,B)]]
  , Game 18 [[(3,R)],[(4,R),(1,B)],[(3,G),(3,R)],[(10,G),(1,B)],[(4,R),(6,G),(1,B)],[(3,G)]]
  , Game 19 [[(4,R),(6,G)],[(11,R),(4,B),(2,G)],[(4,G),(8,R)],[(9,R),(7,G),(2,B)],[(13,R),(4,B)],[(9,R)]]
  , Game 20 [[(2,B),(1,G),(8,R)],[(3,G),(11,B),(1,R)],[(5,B),(4,R),(6,G)],[(6,G),(7,R),(5,B)],[(7,R),(2,G),(1,B)]]
  , Game 21 [[(7,B),(3,G)],[(2,G),(2,R),(7,B)],[(6,B),(3,R),(1,G)],[(9,B),(1,G),(3,R)]]
  , Game 22 [[(7,R),(5,B),(9,G)],[(6,R),(1,B),(5,G)],[(18,R),(7,G),(5,B)],[(13,R),(11,G),(1,B)],[(13,R),(1,B),(11,G)]]
  , Game 23 [[(10,G),(1,B),(5,R)],[(2,R),(4,G)],[(9,G),(2,R)],[(10,G),(1,B),(5,R)]]
  , Game 24 [[(2,R),(6,G),(16,B)],[(3,B),(12,R),(3,G)],[(6,B),(4,R),(12,G)],[(12,G),(14,B),(3,R)]]
  , Game 25 [[(5,R),(2,B),(1,G)],[(4,B),(14,R),(2,G)],[(16,B),(4,R)],[(5,R)],[(12,B),(16,R)],[(2,R),(6,B),(1,G)]]
  , Game 26 [[(10,B),(6,G),(5,R)],[(2,R),(2,G)],[(8,B),(5,R)],[(7,B),(11,G)],[(8,G),(9,B)]]
  , Game 27 [[(1,R),(2,G)],[(6,G),(10,B)],[(1,R),(6,G),(11,B)],[(4,B),(1,G),(1,R)],[(1,R),(7,B)],[(5,G),(2,B),(1,R)]]
  , Game 28 [[(6,B),(5,R),(3,G)],[(5,B),(1,G)],[(1,G),(8,R),(1,B)],[(2,B),(4,G)],[(4,R),(5,B)]]
  , Game 29 [[(2,R),(4,G),(6,B)],[(6,B),(2,G),(1,R)],[(10,G),(13,B),(2,R)],[(11,G),(11,B),(2,R)],[(5,R),(10,G)]]
  , Game 30 [[(4,G),(4,B),(5,R)],[(6,R),(18,G),(7,B)],[(1,R),(11,G),(2,B)],[(11,R),(2,B),(1,G)]]
  , Game 31 [[(1,R),(7,G),(2,B)],[(5,R),(6,G),(9,B)],[(3,G),(1,R),(9,B)],[(3,R)],[(8,B),(6,G),(1,R)],[(14,B),(4,G),(7,R)]]
  , Game 32 [[(11,R),(2,B),(2,G)],[(18,B),(1,G)],[(6,B),(1,G),(15,R)],[(4,R),(2,G)],[(13,R),(6,G),(5,B)],[(7,B),(5,G)]]
  , Game 33 [[(12,B),(2,R),(2,G)],[(5,B),(3,G)],[(2,G),(6,R),(4,B)],[(12,B),(13,R)],[(10,B),(12,R),(1,G)],[(4,B),(4,R)]]
  , Game 34 [[(2,B),(1,R),(6,G)],[(2,B),(1,G)],[(1,R),(2,G),(2,B)],[(17,R),(1,B),(2,G)],[(4,G),(2,R)]]
  , Game 35 [[(2,B),(12,R),(2,G)],[(2,G),(8,R),(11,B)],[(17,R),(16,B)],[(8,B),(8,R)],[(1,G),(6,R),(9,B)]]
  , Game 36 [[(6,R),(14,G),(7,B)],[(1,G),(1,R),(6,B)],[(9,R),(10,B),(9,G)],[(11,B),(14,G),(8,R)],[(10,R),(6,G),(3,B)]]
  , Game 37 [[(6,G)],[(2,R),(5,G)],[(4,B),(4,R),(5,G)],[(1,R),(7,G),(4,B)]]
  , Game 38 [[(1,G),(8,R),(10,B)],[(3,G),(5,R),(12,B)],[(13,B),(5,R),(1,G)],[(3,G),(1,R)],[(3,R),(15,B),(6,G)],[(3,G),(6,R),(4,B)]]
  , Game 39 [[(15,G),(3,B)],[(3,G)],[(3,B),(3,R),(8,G)],[(4,B),(10,G),(4,R)],[(2,G),(5,B),(4,R)],[(3,G),(3,B),(1,R)]]
  , Game 40 [[(2,R),(3,G),(15,B)],[(5,B),(13,G),(2,R)],[(11,B),(1,R)],[(5,B),(20,G),(5,R)]]
  , Game 41 [[(1,R),(2,G),(1,B)],[(10,R)],[(11,G),(1,B),(5,R)],[(10,R),(13,G)]]
  , Game 42 [[(10,R),(8,G),(2,B)],[(5,G),(4,R)],[(6,R)],[(5,R),(9,G),(2,B)],[(2,B),(2,R),(3,G)],[(1,B),(7,R),(2,G)]]
  , Game 43 [[(8,R),(6,B),(12,G)],[(11,G),(2,R),(2,B)],[(4,B),(3,R),(8,G)],[(14,R),(3,B)],[(9,G),(1,B),(5,R)]]
  , Game 44 [[(4,R),(5,B),(4,G)],[(9,B),(1,G)],[(10,G),(2,B),(4,R)],[(5,R),(15,G),(12,B)]]
  , Game 45 [[(1,R),(2,G)],[(5,B)],[(3,B),(1,R)],[(1,B)],[(4,G),(1,R)]]
  , Game 46 [[(3,G),(8,R),(5,B)],[(1,B),(10,R),(5,G)],[(2,G),(5,R),(3,B)],[(5,G),(4,R),(13,B)]]
  , Game 47 [[(2,G),(1,B)],[(2,R),(2,G),(6,B)],[(1,G),(1,R),(1,B)],[(2,G),(4,B),(4,R)],[(2,G),(6,B),(3,R)]]
  , Game 48 [[(4,B),(1,G),(2,R)],[(6,B),(1,R)],[(4,B)]]
  , Game 49 [[(16,B),(18,G),(13,R)],[(7,R),(13,B)],[(14,G),(12,R)],[(20,G),(14,R),(12,B)]]
  , Game 50 [[(8,B),(2,R),(1,G)],[(4,R),(2,G),(5,B)],[(6,B),(2,G)],[(8,B),(3,G),(5,R)],[(1,G),(4,B)]]
  , Game 51 [[(2,B),(8,R)],[(2,G),(3,R),(2,B)],[(12,G)],[(3,B),(10,G),(1,R)],[(13,G),(3,B),(5,R)]]
  , Game 52 [[(12,B),(5,R),(16,G)],[(4,B),(13,G)],[(2,R),(5,B),(5,G)],[(4,G),(8,B),(3,R)]]
  , Game 53 [[(7,B),(5,G)],[(8,G),(8,B)],[(4,R),(1,G)],[(8,B),(5,R),(11,G)]]
  , Game 54 [[(4,B),(3,G),(1,R)],[(10,G),(4,R),(7,B)],[(1,R),(6,B),(2,G)]]
  , Game 55 [[(2,R),(10,B)],[(13,R),(10,B)],[(4,R),(5,B),(4,G)],[(3,G),(8,B)],[(5,B),(7,R),(2,G)]]
  , Game 56 [[(6,G),(7,B),(9,R)],[(3,B),(4,G)],[(15,R),(3,B),(3,G)],[(5,R),(8,G),(7,B)]]
  , Game 57 [[(9,R),(13,B),(2,G)],[(3,R),(2,G),(3,B)],[(1,B),(5,R),(3,G)],[(9,B),(2,G),(2,R)],[(3,R),(12,B),(3,G)],[(2,G),(7,R)]]
  , Game 58 [[(4,B),(7,R)],[(2,B),(5,G),(1,R)],[(17,B),(3,R)],[(5,G),(1,B),(4,R)],[(4,G),(14,B),(3,R)]]
  , Game 59 [[(5,B),(4,R)],[(7,R)],[(4,B),(4,R),(1,G)],[(1,G),(1,B),(5,R)]]
  , Game 60 [[(4,R),(2,G)],[(1,G),(2,B)],[(2,R),(2,G)],[(4,R),(2,G)],[(3,R)]]
  , Game 61 [[(6,R),(14,G)],[(12,G),(3,B)],[(3,B),(16,G),(11,R)]]
  , Game 62 [[(12,G),(2,R),(1,B)],[(14,R),(2,B),(4,G)],[(7,R),(5,G),(1,B)],[(4,G),(14,R),(1,B)],[(2,B),(7,G),(3,R)],[(14,R),(9,G),(2,B)]]
  , Game 63 [[(1,R),(8,B),(12,G)],[(3,G),(10,B),(4,R)],[(2,R),(1,B),(2,G)],[(2,R),(8,G)],[(4,R),(3,B),(9,G)],[(13,G),(4,B)]]
  , Game 64 [[(4,B),(9,G),(4,R)],[(10,G),(6,B),(7,R)],[(10,G),(8,R),(1,B)],[(13,B),(8,G),(8,R)],[(4,G),(1,R),(8,B)]]
  , Game 65 [[(16,B),(5,R),(13,G)],[(5,R),(9,G),(10,B)],[(2,G),(14,R)],[(6,R),(5,G),(5,B)],[(19,B),(4,G),(14,R)],[(7,R),(1,B),(4,G)]]
  , Game 66 [[(7,B),(11,G),(5,R)],[(7,G),(8,R),(10,B)],[(3,R),(1,G)]]
  , Game 67 [[(9,G),(2,B),(13,R)],[(11,R),(10,B)],[(14,R),(1,G),(1,B)],[(1,R),(13,G),(6,B)],[(7,B),(3,G),(5,R)],[(3,G),(2,B)]]
  , Game 68 [[(6,G),(2,B)],[(1,B),(3,R),(5,G)],[(1,B),(10,G)]]
  , Game 69 [[(4,R),(6,B),(1,G)],[(6,B),(2,R),(4,G)],[(9,G),(7,B),(2,R)]]
  , Game 70 [[(11,B),(1,G),(4,R)],[(7,B),(1,G)],[(6,R),(9,B)],[(1,G),(3,R),(7,B)],[(1,G),(9,B),(2,R)]]
  , Game 71 [[(2,G),(6,R)],[(1,B),(2,G),(15,R)],[(6,R),(1,B)],[(2,G),(5,R)]]
  , Game 72 [[(5,G),(6,R)],[(8,R),(1,B),(12,G)],[(1,B),(9,R),(15,G)],[(11,G),(1,B),(6,R)],[(14,G),(5,R)]]
  , Game 73 [[(9,G),(13,R),(1,B)],[(14,G),(5,B),(13,R)],[(13,G),(10,R),(16,B)],[(3,B),(7,R),(1,G)],[(7,R),(6,G),(11,B)]]
  , Game 74 [[(1,B),(9,R),(15,G)],[(3,B),(7,G)],[(9,G),(1,B),(7,R)]]
  , Game 75 [[(5,B),(12,R),(2,G)],[(2,B),(2,G)],[(4,G),(2,R),(7,B)],[(4,G),(7,B),(5,R)],[(1,G),(7,B),(3,R)]]
  , Game 76 [[(1,B)],[(8,R),(13,B)],[(4,G),(7,B),(7,R)],[(3,R),(12,B),(2,G)],[(2,G),(2,B),(1,R)]]
  , Game 77 [[(4,B)],[(4,B)],[(1,B),(1,R)],[(1,R),(5,B)],[(10,B),(1,G)]]
  , Game 78 [[(3,B),(10,G),(6,R)],[(12,R),(7,B),(8,G)],[(2,G),(18,R),(5,B)],[(2,R),(15,B),(14,G)],[(4,G),(6,B),(13,R)]]
  , Game 79 [[(7,R),(1,G)],[(1,B),(6,R),(2,G)],[(1,B),(12,R)]]
  , Game 80 [[(4,R),(6,B),(2,G)],[(5,B),(2,R)],[(6,B),(7,R),(2,G)]]
  , Game 81 [[(2,G),(9,R)],[(2,G),(2,B),(7,R)],[(12,R),(7,G)],[(8,G),(3,R),(3,B)]]
  , Game 82 [[(4,G),(5,B)],[(2,R),(16,B)],[(2,R),(2,G),(18,B)]]
  , Game 83 [[(14,R),(2,G)],[(3,B),(16,R),(2,G)],[(4,G),(13,R),(1,B)]]
  , Game 84 [[(10,G),(6,B),(2,R)],[(5,R),(6,B)],[(7,G),(6,R),(9,B)]]
  , Game 85 [[(1,R)],[(12,R),(1,B),(2,G)],[(6,R),(1,G)],[(12,R),(2,G)]]
  , Game 86 [[(14,R),(1,G),(3,B)],[(3,B)],[(4,G),(8,R),(2,B)],[(10,R),(2,G)]]
  , Game 87 [[(4,R),(9,G),(8,B)],[(3,G),(6,B),(7,R)],[(4,B),(1,R)],[(2,R),(7,B),(11,G)],[(8,G),(2,B),(5,R)],[(6,B),(10,G),(8,R)]]
  , Game 88 [[(1,G),(1,R)],[(2,G),(1,B)],[(3,G),(1,R),(1,B)],[(4,G)],[(1,B),(3,G),(1,R)]]
  , Game 89 [[(11,G),(7,B),(8,R)],[(7,B),(3,G),(2,R)],[(7,G),(6,R),(4,B)],[(1,B),(2,G),(10,R)],[(3,R),(2,B),(1,G)]]
  , Game 90 [[(10,G),(12,R),(2,B)],[(7,R),(7,B),(8,G)],[(2,B),(11,R),(7,G)],[(6,G),(5,R),(2,B)],[(7,R),(10,G)]]
  , Game 91 [[(12,R),(8,G)],[(8,R),(6,G),(3,B)],[(12,R),(4,B),(2,G)]]
  , Game 92 [[(10,B),(3,G)],[(4,R),(13,B),(8,G)],[(7,G),(8,B),(7,R)]]
  , Game 93 [[(7,R),(4,G),(1,B)],[(15,G),(4,R)],[(2,B),(15,R)]]
  , Game 94 [[(10,R),(10,G),(11,B)],[(3,R),(1,G),(7,B)],[(9,R),(4,G),(9,B)],[(7,R),(9,G),(13,B)],[(9,B),(2,G),(10,R)]]
  , Game 95 [[(4,B),(12,G)],[(7,G),(1,R),(5,B)],[(2,B),(8,G),(8,R)]]
  , Game 96 [[(12,G),(2,B)],[(11,G),(3,B)],[(3,R),(2,G),(5,B)],[(12,G),(2,B),(4,R)],[(2,B),(1,G),(1,R)],[(3,R),(11,G),(3,B)]]
  , Game 97 [[(6,R),(3,B),(1,G)],[(1,B),(2,R),(14,G)],[(4,B),(14,G)]]
  , Game 98 [[(13,G),(1,R),(5,B)],[(2,R),(5,G),(7,B)],[(19,G),(5,B)],[(4,B),(13,G)],[(5,G),(8,B)]]
  , Game 99 [[(11,R),(8,G)],[(16,R),(10,G)],[(9,R),(6,G)],[(3,B),(2,R),(4,G)]]
  , Game 100 [[(4,R),(2,B),(4,G)],[(2,G),(1,R),(1,B)],[(3,G),(4,B),(5,R)],[(18,R),(2,B)],[(9,R),(5,G),(4,B)]]
  ]
  
